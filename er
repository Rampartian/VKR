CREATE DATABASE postgres
    WITH 
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'Russian_Russia.1251'
    LC_CTYPE = 'Russian_Russia.1251'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1;

COMMENT ON DATABASE postgres
    IS 'default administrative connection database';

CREATE TABLE public.apptypes
(
    "apptypeID" integer NOT NULL,
    apptypename character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT apptypes_pkey PRIMARY KEY ("apptypeID")
)

TABLESPACE pg_default;

ALTER TABLE public.apptypes
    OWNER to postgres;
    
CREATE TABLE public.citizens
(
    "citizenID" integer NOT NULL,
    surname character varying COLLATE pg_catalog."default" NOT NULL,
    firstname character varying COLLATE pg_catalog."default" NOT NULL,
    patronymic character varying COLLATE pg_catalog."default",
    "e-mail" character varying COLLATE pg_catalog."default" NOT NULL,
    phonenum character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT citizens_pkey PRIMARY KEY ("citizenID")
)

TABLESPACE pg_default;

ALTER TABLE public.citizens
    OWNER to postgres;

CREATE TABLE public.appeal
(
    "appealID" integer NOT NULL,
    text text COLLATE pg_catalog."default" NOT NULL,
    date date NOT NULL,
    apptype integer NOT NULL,
    citizen integer NOT NULL,
    CONSTRAINT appeal_pkey PRIMARY KEY ("appealID"),
    CONSTRAINT apptype FOREIGN KEY (apptype)
        REFERENCES public.apptypes ("apptypeID") MATCH SIMPLE
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
        NOT VALID,
    CONSTRAINT citizen FOREIGN KEY (citizen)
        REFERENCES public.citizens ("citizenID") MATCH SIMPLE
        ON UPDATE RESTRICT
        ON DELETE RESTRICT
        NOT VALID
)

TABLESPACE pg_default;

ALTER TABLE public.appeal
    OWNER to postgres;
    
CREATE TABLE public.registrators
(
    "registratorID" integer NOT NULL,
    surname character varying COLLATE pg_catalog."default" NOT NULL,
    firstname character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT registrators_pkey1 PRIMARY KEY ("registratorID")
)

TABLESPACE pg_default;

ALTER TABLE public.registrators
    OWNER to postgres;


CREATE TABLE public.processing
(
    "registratorID" integer NOT NULL,
    "appealID" integer NOT NULL,
    accepted boolean NOT NULL,
    CONSTRAINT registrators_pkey PRIMARY KEY ("registratorID"),
    CONSTRAINT appeal FOREIGN KEY ("appealID")
        REFERENCES public.appeal ("appealID") MATCH SIMPLE
        ON UPDATE RESTRICT
        ON DELETE RESTRICT,
    CONSTRAINT registrator FOREIGN KEY ("registratorID")
        REFERENCES public.registrators ("registratorID") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID
)

TABLESPACE pg_default;

ALTER TABLE public.processing
    OWNER to postgres;
    
